---
title: "R Notebook on BaseBall Salaries"
output: html_notebook
---

# Introduction
Dis nitebook for dem BaseBall Salaries

## Introduction Subsection
Dis subsection for dem section subsections

```{r}
library(tidyverse);
library(reshape2);
```

Now I will load the data.
```{r}
salary_data <- read.csv("Data/Salaries.csv")
```

Get the size fo the dataframe.
```{r}
dim(salary_data)
```

Here are the first few rows.
```{r}
head(salary_data)
```

Here are the last few rows.
```{r}
tail(salary_data)
```

Obtain the names of the columns.
```{r}
names(salary_data)
```

Obtain summary of stats.
```{r}
summary(salary_data)
```

Make a bar plot indicating the various teams.
```{r}
salary_data %>% ggplot() + geom_bar(mapping = aes(x = teamID))+ coord_flip()
```


# Examine Salary by Year
Consider average player salary by year
```{r}
avgSalByYear <- summarise(group_by(salary_data,yearID),mean_sal = mean(salary))
avgSalByYear
ggplot(avgSalByYear) + geom_line(mapping = aes(x = yearID,y = mean_sal))
```

Now we plot median salaries.
```{r}
medianSalByYear <- summarise(group_by(salary_data,yearID),median_sal = median(salary))
ggplot(medianSalByYear) + geom_line(mapping = aes(x = yearID,y = median_sal))
```

Now we will plot mean and median on the same plot.
```{r}
salary_data <- group_by(salary_data,yearID) %>% summarise(mean_sal = mean(salary),median_sal = median(salary))
salary_data %>% melt(id = "yearID") %>% ggplot(mapping = aes(x = yearID,y = value, color = variable)) + geom_line()
```

```{r}
salary_data %>% ggplot(mapping = aes(x = salary)) + geom_histogram() + facet_wrap(~teamID)
```

Now we will write a function that plots a single team salary histogram.
```{r}
team_year_sal <- function(yearID_val,teamID_val)
{
  salary_data %>% filter(yearID == yearID_val,teamID == teamID_val) %>%
    ggplot(mapping = aes(x = salary)) + 
    geom_histogram() + 
    ggtitle(paste(as.character(yearID_val),teamID_val))
}
```

Now let's use it.
```{r}
team_year_sal(2014,"TEX")
```

Let's make a boxplot!
```{r}
team_year_sal_box <- function(yearID_val,teamID_val)
{
  salary_data %>% filter(teamID == teamID_val,yearID == yearID_val) %>%
    ggplot(mapping = aes(y = salary)) + 
    geom_boxplot() + 
    ggtitle(paste(as.character(yearID_val),teamID_val))
}
```

Now let's use the boxplot.
```{r}
team_year_sal_box(2014,"TEX")
```

Let's determine the total salary spent per team per year.
```{r}
total_sal_spent <- function(yearID_val,teamID_val)
{
  return(filter(salary_data,yearID == yearID_val,teamID == teamID_val))
}

total_sal <- salary_data %>% group_by(yearID, teamID) %>% summarise(total_salary = sum(salary))
total_sal
```

Now we can determine which team spent the most in each year.
```{r}
tot_max <- salary_data %>% 
arrange(filter(total_sal,yearID == 2014),total_salary)# total_sal_spent(2014,salary_data$teamID))
```






